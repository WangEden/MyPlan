<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>任务清单</title>
</head>
<body>
    <h1>我的任务清单</h1>
    <ul id="taskList"></ul>
    <input type="text" id="newTaskContent" placeholder="添加新任务" />
    <button onclick="addTask()">添加任务</button>

    <script>
        const repoName = "YOUR_GITHUB_USERNAME/YOUR_REPO_NAME"; // 更换为您的GitHub用户名和仓库名
        const filePath = "path/to/your/tasks.json"; // 指定tasks.json文件在仓库中的路径
        const accessToken = "YOUR_PERSONAL_ACCESS_TOKEN"; // 更换为您的GitHub个人访问令牌

        // 页面加载时获取任务列表
        window.onload = function() {
            fetchTasks();
        };

        // 从GitHub获取任务列表
        function fetchTasks() {
            fetch(`https://api.github.com/repos/${repoName}/contents/${filePath}`, {
                headers: { "Authorization": `token ${accessToken}` }
            })
            .then(response => response.json())
            .then(data => {
                const tasks = JSON.parse(atob(data.content)).tasks;
                displayTasks(tasks);
            });
        }

        // 显示任务列表
        function displayTasks(tasks) {
            const taskListElement = document.getElementById("taskList");
            taskListElement.innerHTML = ""; // 清空当前列表
            tasks.forEach(task => {
                const taskItem = document.createElement("li");
                taskItem.textContent = task.content + (task.completed ? " (完成)" : "");
                taskListElement.appendChild(taskItem);
            });
        }

        // 添加新任务
        function addTask() {
            const newTaskContent = document.getElementById("newTaskContent").value;
            if (!newTaskContent.trim()) return;

            // 这里只是简单示例，实际操作中您需要更新GitHub中的tasks.json
            console.log("添加任务：", newTaskContent);
            // 重置输入框
            document.getElementById("newTaskContent").value = "";
        }

        // 更新GitHub上的tasks.json文件（示例中未实现）
        function updateTasksOnGitHub(updatedTasks) {
            // 将更新后的任务列表转换为Base64编码的字符串
            const contentBase64 = btoa(JSON.stringify({ tasks: updatedTasks }));

            // 使用GitHub API更新文件
            // 注意：这里需要处理更新逻辑，包括获取文件的SHA等
            console.log("更新GitHub上的tasks.json文件");
        }
    </script>
</body>
</html>